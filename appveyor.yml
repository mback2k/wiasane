os: Windows Server 2012 R2

configuration:
- Debug
- Release

platform:
- Win32
- x64

install:
- ps: >-
    Write-Host "Downloading WDK 8..."
    
    $exePath = "$($env:USERPROFILE)\WindowsAzureAuthoringTools-x64.msi"
    
    (New-Object Net.WebClient).DownloadFile('http://download.microsoft.com/download/2/4/C/24CA7FB3-FF2E-4DB5-BA52-62A4399A4601/wdk/wdksetup.exe', $exePath)
    
    Write-Host "Installing WDK 8..."
    
    cmd /c start /wait "$exePath" /quiet /norestart
    
    del $exePath

before_build:
- ps: >-
    Get-ChildItem . -include *.vcxproj.user -recurse | foreach ($_) {Remove-Item $_.FullName}
    
    $p = 'C:\Program Files (x86)\Windows Kits\8.0\build\WindowsDriver8.0.x64.props'
    
    $c = [IO.File]::ReadAllText($p)
    
    $c = $c.Replace('''$(VisualStudioVersion)'' != ''11.0''', '''$(VisualStudioVersion)'' &lt;''11.0''')
    
    [IO.File]::WriteAllText($p, $c)
    
    $p = 'C:\Program Files (x86)\Windows Kits\8.0\build\WindowsDriver8.0.Win32.props'
    
    $c = [IO.File]::ReadAllText($p)
    
    $c = $c.Replace('''$(VisualStudioVersion)'' != ''11.0''', '''$(VisualStudioVersion)'' &lt;''11.0''')
    
    [IO.File]::WriteAllText($p, $c)
    
build:
  verbosity: detailed
